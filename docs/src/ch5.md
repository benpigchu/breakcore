# 第五章：进程管理

## 完善创建和结束进程的过程

首先，为了之后用户程序可以按照用户程序的名称来启动其它用户程序，我们需要在装载应用程序时同时装载它的名称。为此，我们更改 `build.rs` 使其在生成 `embed_app.asm` 时在其中包含应用的名称信息。

其次，我们需要对 `task` 模块进行较大的重构。一方面我们要把 `Task` 中可变的部分放入 `Mutex` 中，而 `TaskManager` 存放的 `Task` 数组也改为 `Vec<Arc<Task>>` 。另一方面我们要把 `Task` 初始化的工作放入它的构造函数中，并删除任务未初始化的状态。

然后，为了方便之后实现 `fork` 和 `exec`，我们需要把加载 ELF 和用户栈的部分与初始化用户程序上下文和内核栈的部分分离开。